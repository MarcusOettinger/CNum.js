function CNum(t){function r(t){return P*t}function o(t){return P*t}function e(t){return z+r(t)}function n(t){return N-o(t)}function s(t){return"number"==typeof t?t?0>t?-1:1:t===t?0:0/0:0/0}function a(t,r,o){return m=t>r?t:r,o>m?o:m}function d(t,r){return t>r?r:t}function u(t){for(z=C.width()/2,N=C.height()/2,k=C.width()-2*S,g=C.height()-2*S,P=d(k,g)/(2*t),v=t;t/A>10;)A=10*A;A>10&&(A=2*A)}function h(t){C.drawLine({strokeStyle:"#000",strokeWidth:2,rounded:!1,endArrow:!1,x1:e(t),y1:N,x2:e(t),y2:N+T}),C.drawText({strokeStyle:"#000",strokeWidth:1,x:e(t),y:N+10,fontSize:10,fontFamily:"serif",text:t}),C.drawLine({strokeStyle:"#000",strokeWidth:2,rounded:!1,endArrow:!1,x1:z,y1:n(t),x2:z-T,y2:n(t)}),C.drawText({strokeStyle:"#000",strokeWidth:1,x:z-20,y:n(t)+3,fontSize:10,fontFamily:"serif",text:t})}function l(){if(null!=C)for(C.drawLine({strokeStyle:"#000",strokeWidth:2,rounded:!1,endArrow:!0,arrowRadius:10,arrowAngle:90,x1:S,y1:N,x2:k+S,y2:N}),C.drawLine({strokeStyle:"#000",strokeWidth:2,rounded:!1,endArrow:!0,arrowRadius:10,arrowAngle:90,x1:z,y1:g+S,x2:z,y2:S}),i=A;i<=v;i+=A)h(i)}function c(t,r,o){xpos=e(t),ypos=n(r),C.drawLine({strokeStyle:o,strokeWidth:1,x1:xpos,y1:N,x2:xpos,y2:ypos}),C.drawLine({strokeStyle:o,strokeWidth:1,x1:z,y1:ypos,x2:xpos,y2:ypos})}function f(t,i,a,d){xpos=e(t.x),ypos=n(t.y),x=r(a),y=o(d),style=i.colarrow?i.color:"#000",i.Arrow?C.drawLine({strokeStyle:style,strokeWidth:2,rounded:!1,endArrow:!0,arrowRadius:10,arrowAngle:45,x1:z+x,y1:N-y,x2:xpos+x,y2:ypos-y}):C.drawRect({strokeStyle:style,strokeWidth:2,fromCenter:!0,x:xpos,y:ypos,width:5,height:5}),i.Ctext&&C.drawText({strokeStyle:style,strokeWidth:1,x:xpos+x+10,y:ypos-10*s(t.y)-y,fontSize:12,fontFamily:"serif",text:"z ="+math.complex(t.x,t.y).toString()})}function p(t,r){style=r.colarrow?r.color:"#000",C.drawArc({strokeStyle:style,x:z,y:N,radius:50+2*W,start:Math.PI/2-t,end:Math.PI/2,inDegrees:!1}),tx=z+30*math.cos(t-Math.PI/6),ty=N-30*math.sin(t-Math.PI/6),C.drawText({strokeStyle:style,strokeWidth:1,x:tx,y:ty,fontSize:12,fontFamily:"serif",text:math.round(t,2)})}function w(){null!=C&&C.drawArc({draggable:!1,strokeStyle:"#999",strokeWidth:1,x:z,y:N,radius:I*P})}var k,g,S=50,z=100,N=100,P=10,v=1,T=3,C=null,W=0,A=.001,R={clear:!1,coords:!1,Arrow:!0,circle:!1,ReIm:!0,Ctext:!0,arc:!0,color:"#888",colarrow:!1};zStr=math.eval(t),this.zNum=math.complex(zStr),this.x=math.round(this.zNum.re,3),this.y=math.round(this.zNum.im,3);var I=this.zNum.toPolar().r,L=this.zNum.toPolar().phi;return this.angle=0>L?2*Math.PI+L:L,this.getradius=function(){return I},this.ToCartesian=function(){return retval=this.zNum.format(3),retval},this.ToCC=function(){return retval=math.conj(this.zNum).format(3),retval},this.ToR=function(){return retval=math.round(this.zNum.toPolar().r,3),retval},this.ToTrigonometric=function(){return rad=math.round(this.zNum.toPolar().r,3),phi=math.round(this.zNum.toPolar().phi,3),retval=rad+"&middot;(cos("+phi+") + i &middot;sin("+phi+"))",retval},this.ToPolar=function(){return rad=math.round(this.zNum.toPolar().r,3),phi=math.round(this.zNum.toPolar().phi,3),retval=rad+"&middot; e<sup>i "+phi+"</sup>",retval},this.setCanvas=function(t){C=t},this.getXPos=function(t){return e(t)},this.getYPos=function(t){return n(t)},this.multiplyCNum=function(t,r,o){return o="undefined"==typeof o?r:o,res=new CNum(math.multiply(this.zNum,t.zNum).toString()),this.displayGauss(r,a(this.getradius(),t.getradius(),res.getradius())),this.addToPlot(t,r),this.addToPlot(res,o),res},this.addCNum=function(t,r,o){return o="undefined"==typeof o?r:o,res=new CNum(this.zNum.toString()+"+"+t.zNum.toString()),this.displayGauss(r,a(this.getradius(),t.getradius(),res.getradius())),this.addVector(t,this.x,this.y,r),this.addToPlot(res,o),res},this.addToPlot=function(t,r){var o=$.extend({},R,r);o.arc&&p(t.angle,o),o.ReIm&&c(t.x,t.y,o.color),f(t,o,0,0),W++},this.addVector=function(t,r,o,e){var i=$.extend({},R,e);i.arc&&p(t.angle,i),i.ReIm&&c(t.x,t.y,i.color),f(t,i,r,o),W++},this.displayGauss=function(t,r){maxR="undefined"==typeof r?I:r;var o=$.extend({},R,{clear:!0,coords:!0,circle:!0},t);u(maxR),o.clear&&(C.clearCanvas(),W=0),o.coords&&l(),o.circle&&w(),this.addToPlot(this,o)},this}
